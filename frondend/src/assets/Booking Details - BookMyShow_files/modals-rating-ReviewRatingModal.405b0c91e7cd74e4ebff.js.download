"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[20787,22228,53672,77882,84296],{27835:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var i=s(96540),a=s(62486),n=s(74848);const r=e=>{let{range:t="0",updateRange:s=()=>{},updateGARatingCallback:r=()=>{},updateCSRatingCallback:l=()=>{},isAddReview:o=!1,isMobile:d=!1,svgName:c="star",ratingIds:g=[{id:0,value:""}],isPTMPage:h=!1}=e;const[u,p]=(0,i.useState)("0"),[m,v]=(0,i.useState)("0"),[_,R]=(0,i.useState)("0"),[E,x]=(0,i.useState)("1"),[S,A]=(0,i.useState)("-6"),[N,I]=(0,i.useState)(!0),w=(0,i.useRef)(null),C=(0,i.useRef)(null),{value:T=""}=g[t]||{};(0,i.useEffect)((()=>{const e=C.current.offsetWidth,t=w.current.parentNode;t&&t.parentNode;R(e),o&&A("20px")}),[]);const f="0"===u?0:m;return(0,n.jsxs)("div",{className:"rating-section",ref:w,children:["0"===t?(0,n.jsxs)("div",{className:`slide-to-rate ${!d&&"desktop-slide-rate"}`,children:[(0,n.jsx)("span",{className:"text",children:"Slide to rate"}),(0,n.jsx)("span",{className:"icon",children:(0,n.jsx)(a.default,{fileName:"common",svgName:"next-arrow"})})]}):null,(0,n.jsxs)("div",{className:"rating-slider-wrapper",children:[(0,n.jsxs)("div",{className:`rating-slider ${!d&&"desktop-rating-slider"}`,children:[(0,n.jsx)("input",{id:"range",type:"range",value:t,ref:C,min:"0",max:"10",step:"1",onChange:e=>{if(!o){const t=e.target.value;s(t),d?("0"===t?(v("0"),A("-6px"),x("1")):(A("20px"),x("0")),"0"!==t&&"90"!==t&&"100"!==t&&v(u>t?"20":"-20")):A("0"===t?"-6px":"20px"),p(t)}},onTouchEnd:()=>{const e=w.current.parentNode,t=e&&e.parentNode,s=document.querySelector(".review-rating-wrapper .main"),i="0"!==u;s&&s.classList.remove("fixed"),o||(v("0"),setTimeout((()=>{i&&N&&t&&t.children[2].scrollIntoView({block:"start",behavior:"auto"})}),500),I(!1),r&&r(),l&&l())},onTouchStart:e=>{if(!o){e.target.focus();const t=document.querySelector(".review-rating-wrapper .main");t&&t.classList.add("fixed"),v("0")}}}),(0,n.jsx)("div",{className:"dividers"}),(0,n.jsx)("div",{className:"selected-rating",id:"rating-range",style:{width:10*t+"%"},children:(0,n.jsxs)("div",{className:"slider-track",style:{minWidth:`${_}px`},children:[(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{})]})}),(0,n.jsx)("div",{className:"range-thumb",style:{left:10*t+"%"}}),(0,n.jsx)("div",{className:"heart-icon",id:"hearticon",style:{left:10*t+"%",transform:`translateX(-15px) rotate(${f}deg`,marginBottom:`${S}`,zIndex:`${E}`},children:(0,n.jsx)("span",{className:"icon",children:(0,n.jsx)(a.default,{fileName:"common",svgName:c,width:"100%",height:"100%"})})})]}),(0,n.jsx)("div",{className:"slider-count",children:(0,n.jsx)("span",{id:"output",children:T})})]})]})}},48125:(e,t,s)=>{s.r(t),s.d(t,{failureAEventReviewOfUser:()=>h,failurePostwatchUserReview:()=>v,failureSaveRatingOnly:()=>r,failureSaveReviewAndRating:()=>d,hideUserReviewModal:()=>_,receivePostwatchUserReview:()=>m,receiveSaveRatingOnly:()=>n,receiveSaveReviewAndRating:()=>o,recieveAEventReviewOfUser:()=>g,requestAEventReviewOfUser:()=>c,requestPostwatchUserReview:()=>p,requestSaveRatingOnly:()=>a,requestSaveReviewAndRating:()=>l,setDefaultReviewRatingToastMsg:()=>u});var i=s(88629);const a=()=>({type:i.REQUEST_SAVE_RATING_ONLY}),n=e=>({type:i.RECEIVE_SAVE_RATING_ONLY,data:e}),r=e=>({type:i.FAILURE_SAVE_RATING_ONLY,error:e}),l=()=>({type:i.REQUEST_SAVE_REVIEW_RATING}),o=e=>({type:i.RECEIVE_SAVE_REVIEW_RATING,data:e}),d=e=>({type:i.FAILURE_SAVE_REVIEW_RATING,error:e}),c=()=>({type:i.REQUEST_SAVE_REVIEW_RATING}),g=e=>({type:i.RECEIVE_SAVE_REVIEW_RATING,data:e}),h=e=>({type:i.FAILURE_SAVE_REVIEW_RATING,error:e}),u=e=>({type:i.RESET_RATING_VALUES,data:e}),p=()=>({type:i.REQUEST_POSTWATCH_USER_REVIEW}),m=e=>({type:i.RECEIVE_POSTWATCH_USER_REVIEW,data:e}),v=e=>({type:i.FAILURE_POSTWATCH_USER_REVIEW,error:e}),_=e=>({type:i.HIDE_USER_REVIEW_MODAL,data:e})},74845:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var i=s(64467),a=s(96540),n=s(71468),r=s(45173),l=s(6161),o=s(56314),d=s(62486),c=s(40466),g=s(66864),h=s(45441),u=s(48125),p=s(38548),m=s(7982),v=s(27835),_=s(69254),R=s(86609),E=s(74848);const x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{font:t="",color:s="",weight:i=""}=e;return{fontSize:t,color:s,fontWeight:i}},S={width:"100%",height:"100vh",display:"flex",flexDirecttion:"column",alignItems:"center",justifyContent:"center",background:"#fff"};class A extends a.Component{constructor(e){super(e),(0,i.A)(this,"handleScroll",(()=>{const e=this.ratingModalScroll?.current?.scrollTop||0,t=this.imageWrapper?.current?.offsetHeight||0;this.setState({scrollTop:e-t})})),(0,i.A)(this,"removeRnRModal",(()=>{const{dispatch:e=()=>null,pageType:t="",eventCode:s="",handleClose:i=()=>null,type:a=""}=this.props;"discovery"===t&&e((0,m.setLocalStorage)({name:p.SEARCH_RNR_BOTTOMSHEET,value:s})),i(),"synopsis"!==a&&"PTM"!==a&&window.scrollTo(0,0)})),(0,i.A)(this,"removeModal",(()=>{const{cookies:e={},regionCode:t="",subCode:s="",userDetail:i={},eventCode:a="",isLoggedIn:n=!1,EventGroup:r="",selectedValue:l=""}=this.props;this.removeRnRModal();const o={region_code:t,sub_region_code:s,isLoggedIn:n,event_group:r,rating_percentage:l||"",event_code:a,member_id:i?i.MEMBERID:""};(0,R.reviewModalCloseClickGAEvent)(o,e)})),(0,i.A)(this,"onDescriptionChange",(e=>{const t=e.currentTarget.value;this.checkDescription(t)})),(0,i.A)(this,"validateFields",(()=>{const{selectedValue:e,descriptionText:t}=this.state;"0"!==e?t.length?this.setState({disableSubmitButton:!1}):0===t.length?this.setState({disableSubmitButton:!1,descFieldClass:""}):this.setState({disableSubmitButton:!0}):this.setState({disableSubmitButton:!0})})),(0,i.A)(this,"checkDescription",(e=>{this.setState({descriptionText:e},this.validateFields)})),(0,i.A)(this,"onElementFocus",(e=>{this.checkDescription(e.currentTarget.value),this.setState({inputScroll:!1,inputLabelTextFocus:!1})})),(0,i.A)(this,"onElementBlur",(()=>{this.setState({inputScroll:!0,inputLabelTextFocus:!0})})),(0,i.A)(this,"handleCloseToast",(()=>{const{dispatch:e=()=>null}=this.props;setTimeout((()=>{e((0,u.setDefaultReviewRatingToastMsg)({}))}),2e3),setTimeout((()=>{e((0,m.deleteCookie)({name:p.RNR_VIEWIT_DATA}))}),2500)})),(0,i.A)(this,"updateRange",(e=>{const t=document.getElementsByClassName("tag");for(let e=0;e<t.length;e+=1)t[e].classList.remove("selected");this.setState({selectedValue:e,startHeartAniomation:!0,hashtagList:[]},this.validateFields)})),(0,i.A)(this,"updateGARatingCallback",(()=>{const{cookies:e={},regionCode:t="",subCode:s="",userDetail:i={},eventCode:a="",isLoggedIn:n=!1,EventGroup:r=""}=this.props,{selectedValue:l}=this.state,o={region_code:t,sub_region_code:s,isLoggedIn:n,rating_percentage:l,event_code:a,event_group:r,member_id:i?i.MEMBERID:""};(0,R.ratingUpdateGAEvent)(o,e)})),(0,i.A)(this,"updateCSRatingCallback",(()=>null)),(0,i.A)(this,"submitRatings",(async()=>{const{eventCode:e="",dispatch:t=()=>null,regionCode:s="",type:i="",subCode:a="",cookies:n={},userDetail:r={},pathname:d,title:c="",isLoggedIn:g=!1,EventGroup:h="",handleOnSubmitCallback:u=()=>null,eventTitle:v="",initReviewAndRatingData:E={},regionNameSlug:x}=this.props,{ratingSection:S={}}=E||{},{ratingIds:A=[]}=S,N=(0,o.slugify)(v),{descriptionText:I,selectedValue:w,hashtagList:C}=this.state,T=A.find((e=>{let{id:t}=e;return t.toString()===w}))||{},{id:f=0}=T;let b={eventCode:e,ratingId:f};this.setState({isLoadingBtn:!0}),(C.length||I)&&(b={...b,hashtags:C.length?C:[],reviewText:I||""}),window.scrollTo(0,0);const y=await t((0,_.insertReviewAndRating)(b));if("synopsis"!==i&&"PTM"!==i||!y)t((0,m.setLocalStorage)({name:p.RNR_VIEWIT_DATA,value:{eventCode:e,movieName:c}}));else{u({currentUserRating:w,hasUserRated:!0})}if(t((0,m.setLocalStorage)({name:p.SEARCH_RNR_BOTTOMSHEET,value:e})),this.setState({isLoadingBtn:!1}),this.handleCloseToast(),this.removeRnRModal(),y)if(d.indexOf("/user-reviews")>-1){const e=`${d}`;window.location.assign(e)}else if(d.indexOf("/critic-reviews")>-1){const e=`${d.split("/critic-reviews")[0]}/user-reviews`;window.location.assign(e)}else{const t=`${l.BASE_URL}movies/${x}/${N}/${e}/user-reviews`;window.location.assign(t)}const j={region_code:s,sub_region_code:a,isLoggedIn:g,rating_percentage:w,event_code:e,event_group:h,member_id:r?r.MEMBERID:""};(0,R.reviewModalSubmitGAEvent)(j,n)})),(0,i.A)(this,"addHashTags",(e=>{const{hashtagList:t}=this.state,s=e.target,i=s&&s.dataset.hashtag,a=s&&s.dataset.hashtagid,n=[...t];s.classList.contains("selected")?(s.classList.remove("selected"),n.filter(((e,t)=>e.Value===i&&n.splice(t,1))),this.setState({hashtagList:n})):(s.classList.add("selected"),n.push({Id:a,Value:i}),this.setState({hashtagList:n}))})),(0,i.A)(this,"validateDescField",(e=>{const{value:t}=e.currentTarget;return t.length>=0||!t.length})),(0,i.A)(this,"handleImageError",(e=>{e.target.setAttribute("src",l.NO_IMAGE_PLACEHOLDER)})),(0,i.A)(this,"handleButtonError",(()=>{window.location.reload()})),this.state={disableSubmitButton:!0,isLoadingBtn:!1,startHeartAniomation:!1,selectedValue:"0",inputScroll:!1,scrollHeight:0,descriptionText:"",inputLabelTextFocus:!1,descFieldClass:"",scrollTop:-1,hashtagList:[]},this.ratingModalScroll=(0,a.createRef)(),this.imageWrapper=(0,a.createRef)()}componentDidMount(){const{cookies:e={},regionCode:t="",subCode:s="",userDetail:i={},eventCode:a="",isLoggedIn:n=!1,EventGroup:r="",ratingValue:l="0"}=this.props,d=(0,o.getIn)(this,["imageWrapper","current","offsetHeight"])||270,c=window.innerHeight-2*d,g="0"!==l;this.setState({scrollHeight:c?c+66:0,selectedValue:l||"0",disableSubmitButton:!g,startHeartAniomation:g}),document.addEventListener("scroll",this.handleScroll,!(0,o.supportsPassive)()||{passive:!0,capture:!0});const h={region_code:t,sub_region_code:s,isLoggedIn:n,event_code:a,event_group:r,member_id:i?i.MEMBERID:""};(0,R.reviewModalOnLoadGAEvent)(h,e)}componentWillUnmount(){document.removeEventListener("scroll",this.handleScroll,!(0,o.supportsPassive)()||{passive:!0,capture:!0})}renderHashtagList(e){return e.map((e=>{let{id:t,value:s}=e;return(0,E.jsx)("div",{className:"review-tag","data-hashtagid":t,"data-hashtag":s,onClick:this.addHashTags,role:"button",tabIndex:[0],children:s},t)}))}renderHashtag(){const{initReviewAndRatingData:e={}}=this.props,{selectedValue:t}=this.state,{hashtagSection:s={}}=e||{},{hashtags:i=[],secondaryText:a={}}=s,{text:n="",style:r={}}=a;return i.map((e=>{let{value:s,bucketId:i,primaryText:a,hashtags:l}=e;const o=t===s.toString(),{text:d="",style:c={}}=a;return o&&(0,E.jsxs)("div",{className:"hashtag-section",children:[(0,E.jsxs)("div",{className:"heading",children:[(0,E.jsx)("div",{className:"title",style:x(c),children:d}),(0,E.jsx)("div",{className:"subtitle",style:x(r),children:n})]}),(0,E.jsx)("div",{className:"review-hashtag-list",children:(0,E.jsx)("div",{className:"review-hashtags",children:this.renderHashtagList(l)})})]},i)}))}renderSubmitRatingsBtn(){const{initReviewAndRatingData:e={}}=this.props,{disableSubmitButton:t,isLoadingBtn:s,hashtagList:i,descriptionText:a}=this.state,n=a&&a.trim(),{ctaSection:r={}}=e||{},{primaryCta:l={},secondaryCta:o={}}=r,{text:d="",style:c=""}=i.length||n?o:l;return(0,E.jsx)(g.default,{appearance:"primary",disabled:t,isLoading:s,onClick:this.submitRatings,componentStyle:x(c),children:d})}render(){const{scrollTop:e,selectedValue:t,scrollHeight:s,inputScroll:i,startHeartAniomation:a,descFieldClass:n,inputLabelTextFocus:r}=this.state,{eventTitle:o="",watchedStatus:g="",type:u="",isReviewOnly:p=!1,appConfigurationObject:m={},initReviewAndRatingData:_={}}=this.props,{isDesktop:R}=m,A=!R,N="PTM"===u,{message:I=""}=_||{},{headerSection:w={},ratingSection:C={},reviewSection:T={}}=_||{},{imageCode:f="",primaryText:b={},secondaryText:y={}}=w,{primaryText:j={},secondaryText:L={},svgName:D="",ratingIds:M=[],iconRatingSVGName:O=""}=C,{onClickText:k={},placeHolderText:V={},primaryText:B={},secondaryText:G={}}=T,{text:U="",style:H={}}=b,{text:$="",style:P={}}=j,{text:W="",style:F={}}=y,{text:K="",style:q={}}=L,{text:Q=""}=k,{text:Y=""}=V,{text:z="",style:X={}}=B,{text:J="",style:Z={}}=G;return(0,E.jsx)("div",{className:`review-rating-wrapper animate-rotate-pull-bottom ${A&&"mobile-rating-wrapper"}`,children:(0,E.jsxs)("div",{className:`rating-content full-screen ${!A&&"desktop-container"}`,children:[(0,E.jsx)("div",{className:`head ${A&&"mobile-header"}`,children:(0,E.jsxs)("div",{className:"header-column",children:[(0,E.jsx)("div",{className:"left-section"}),(0,E.jsxs)("div",{className:"center-section",children:[(0,E.jsx)("h4",{className:`${e>=0&&"animate-fade-in"}`,style:x(H),children:U}),e>=0&&(0,E.jsx)("h2",{className:"animate-fade-in",children:o})]}),(0,E.jsx)("div",{className:"right-section",onClick:this.removeModal,role:"button",tabIndex:[0],children:(0,E.jsx)("span",{className:"icon",children:(0,E.jsx)(d.default,{fileName:"common",svgName:"cross"})})})]})}),I?(0,E.jsx)(h.default,{type:"API_FAILURE",buttonClickHandler:this.handleButtonError,customContainerStyle:S,customDescription:I}):(0,E.jsxs)("div",{children:[(0,E.jsxs)("div",{className:`main ${"synopsis"===u&&"scroll-out"} ${A&&i&&"scroll-up"} ${!A&&"desktop-main"}`,ref:this.ratingModalScroll,children:[A&&i&&(0,E.jsx)("div",{className:"blank-section"}),A&&(0,E.jsx)("div",{className:"image-wrapper",ref:this.imageWrapper,children:(0,E.jsxs)("div",{className:"inner-details",children:[(0,E.jsx)("img",{className:"featured",alt:"review-rating-modal-img",src:f?`${l.MOVIE_IMG_URL}${f}.jpg`:l.NO_IMAGE_PLACEHOLDER,onError:this.handleImageError}),(0,E.jsxs)("div",{className:"details",children:[(0,E.jsx)("div",{className:"name",style:x(F),children:W}),g&&(0,E.jsxs)("div",{className:"watched",children:["You watched ",g]})]})]})}),(0,E.jsxs)("div",{className:`rating-details animate-rotate-pull-top ${!A&&"desktop-rating-details"}`,children:[(0,E.jsxs)("div",{className:`rating-wrapper ${A&&"mobile-rating-wrapper"}`,children:[(0,E.jsx)("div",{className:"title",style:x(P),children:$}),(0,E.jsx)(v.default,{range:t,isAddReview:p||!1,updateRange:this.updateRange,updateGARatingCallback:this.updateGARatingCallback,updateCSRatingCallback:this.updateCSRatingCallback,isMobile:A,svgName:D,ratingIds:M,isPTMPage:N})]}),(0,E.jsx)("div",{className:`ratings-matter ${a&&"0"!==t&&"animate-out"}`,style:{height:`${a} && ${s}px`},children:(0,E.jsxs)("div",{className:"ratings-matter-inner",children:[(0,E.jsx)("div",{className:"icon",children:(0,E.jsx)(d.default,{fileName:"synopsis",svgName:O})}),(0,E.jsx)("div",{className:"text",style:x(q),children:K})]})}),"0"!==t?(0,E.jsxs)("div",{children:[this.renderHashtag(),(0,E.jsx)("div",{className:`form-wrapper ${a&&"0"!==t&&"animate-fade-in"}`,children:(0,E.jsxs)("div",{className:"form-section",children:[(0,E.jsxs)("div",{className:"title",style:x(X),children:[z," ",(0,E.jsx)("span",{style:x(Z),children:J})]}),(0,E.jsx)("div",{className:"text-review-section struktur",children:(0,E.jsx)(c.default,{id:"description",customValidation:this.validateDescField,className:n,type:"text",placeholder:r?Q:Y,required:!1,errorMessage:" ",onScrollFocus:!0,onFocus:this.onElementFocus,onBlur:this.onElementBlur,onInputCallBack:this.onDescriptionChange})})]})})]}):null]}),A&&a&&"0"!==t&&(0,E.jsx)("div",{className:"scroll-area",style:{height:`${s}px`}})]}),(0,E.jsx)("div",{className:`btn-fixed ${A&&"mobile-btn"}`,children:(0,E.jsx)("div",{className:"btn-wrapper",children:this.renderSubmitRatingsBtn()})})]})]})},"movie-format-selector-animate")}}const N=(0,r.withRouter)((0,n.Ng)((function(e){return{userDetail:e.cookies[p.COOKIE_USER_DETAIL],reviewRating:e.iedb.reviewRating,userReviewDetail:e.synopsisStore.ratingAndReviews.userReviewDetail,appConfigurationObject:(0,o.getAppConfigurationObject)(e),initReviewAndRatingData:e.synopsisStore.ratingAndReviews.initReviewAndRatingData,insertReviewAndRatingData:e.synopsisStore.ratingAndReviews.insertReviewAndRatingData}}))(A))},86609:(e,t,s)=>{s.r(t),s.d(t,{ratingUpdateGAEvent:()=>l,reviewModalCloseClickGAEvent:()=>d,reviewModalOnLoadGAEvent:()=>r,reviewModalSubmitGAEvent:()=>o});var i=s(38548),a=s(6161),n=s(47532);const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={event:"gtm_allpage_RR",event_type:"screen_view",screen_name:"submit_rating",event_name:"submit_rating_viewed",app_code:a.APP_CODE,product:"movies",user_mode:""+(e.isLoggedIn?"logged_in":"guest"),session_id:t[i.CLICKSTREAM_SESSION_ID]||"",bms_id:t[i.CLICKSTREAM_BMS_ID]||"",...e};(0,n.pushDataToAnalytics)("GA","",{},s)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={event:"gtm_std_event_RR",event_type:"click",screen_name:"submit_rating",event_name:"toggle_rating_slider_clicked",product:"movies",app_code:a.APP_CODE,user_mode:""+(e.isLoggedIn?"logged_in":"guest"),session_id:t[i.CLICKSTREAM_SESSION_ID]||"",bms_id:t[i.CLICKSTREAM_BMS_ID]||"",...e};(0,n.pushDataToAnalytics)("GA","",{},s)},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={event:"gtm_std_event_RR",event_type:"click",screen_name:"submit_rating",event_name:"submit_rating_button_clicked",product:"movies",app_code:a.APP_CODE,user_mode:""+(e.isLoggedIn?"logged_in":"guest"),session_id:t[i.CLICKSTREAM_SESSION_ID]||"",bms_id:t[i.CLICKSTREAM_BMS_ID]||"",...e};(0,n.pushDataToAnalytics)("GA","",{},s)},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={event:"gtm_std_event_RR",event_type:"click",screen_name:"submit_rating",event_name:"submit_rating_close_clicked",app_code:a.APP_CODE,product:"movies",user_mode:""+(e.isLoggedIn?"logged_in":"guest"),session_id:t[i.CLICKSTREAM_SESSION_ID]||"",bms_id:t[i.CLICKSTREAM_BMS_ID]||"",...e};(0,n.pushDataToAnalytics)("GA","",{},s)}}}]);